# üéØ Objetivos del Pr√°ctico

## Prop√≥sito General
Este pr√°ctico tiene como objetivo desarrollar competencias en el **an√°lisis de asociaci√≥n entre variables categ√≥ricas** mediante:

1. **Construcci√≥n** de tablas de contingencia
2. **Aplicaci√≥n** de la prueba de independencia Chi-cuadrado (œá¬≤)
3. **Interpretaci√≥n** de resultados estad√≠sticos y sustantivos
4. **Contraste** entre c√°lculo manual y automatizado

## Contexto del Estudio
Utilizaremos la **cuarta ola (2019) del Estudio Longitudinal Social de Chile (ELSOC)**, una encuesta panel representativa nacional, para analizar la relaci√≥n entre **nivel educacional** y **preferencias pol√≠tico-democr√°ticas**.

---

# üîß Preparaci√≥n del Entorno Anal√≠tico

## 1.1 Instalaci√≥n y Carga de Paquetes

```{r librerias, eval=FALSE}
# Carga de paquetes necesarios
pacman::p_load(
  tidyverse,      # Manipulaci√≥n y visualizaci√≥n de datos
  sjPlot,         # Tablas y gr√°ficos para ciencias sociales
  psych,          # An√°lisis psicom√©tricos y correlaciones
  DescTools,      # Funciones descriptivas avanzadas
  gginference,    # Visualizaci√≥n de pruebas inferenciales
  rempsyc,        # Reportes estad√≠sticos formateados
  broom,          # Organizaci√≥n de resultados en dataframes
  sjlabelled,     # Manejo de etiquetas de variables
  sjmisc          # Funciones auxiliares para an√°lisis
)
```
# Configuraci√≥n del entorno R
options(scipen = 999)    # Desactiva notaci√≥n cient√≠fica
rm(list = ls())          # Limpia el entorno de trabajo
set.seed(123)            # Fija semilla para reproducibilidad

# Carga de la base de datos
Luego vamos a cargar la base de datos directamente desde internet (En este caso la base de datos ELSOC esta alojada en Harvard Dataverse)


```{r, eval=FALSE}
#Cargamos la base de datos desde internet
load(url("https://dataverse.harvard.edu/api/access/datafile/7245118")) 

dim(elsoc_long_2016_2022.2)
```
##Salida Esperada:
```{r, eval=FALSE}
[1] 18035   750
```
**Interpretaci√≥n:** La base contiene 18,035 casos (entrevistados) medidos en 750 variables a lo largo de diferentes olas.

---

Selecci√≥n y Limpieza de Variables:

```{r, eval=FALSE}
proc_data <- elsoc_long_2016_2022.2 %>% filter(ola=="4") %>% 
  select(c29, # Confianza generalizada
         m01# nivel educacional
         )

proc_data <- proc_data %>% sjlabelled::set_na(., na = c(-999, -888, -777, -666))
# Comprobar
names(proc_data)
```
**Se renombran las variables para mayor claridad:**

- m01 ‚Üí educacion (nivel educacional).

- c25 ‚Üí aut_demo (preferencia entre autoritarismo o democracia).

- Se elimina los NA¬¥s (Importante verificar como es que funcionan los NA¬¥s o si realmente tiene)}

- Con names(proc_data) vemos los nombres de las variables (columnas)

---

# Recodificaci√≥n de variables
```{r, eval=FALSE}
proc_data$educacion <- car::recode(proc_data$educacion, "c(1,2,3)=1; c(4,5)=2; c(6,7,8,9,10)=3")

proc_data$educacion <- sjlabelled::set_labels(proc_data$educacion,
                                              labels=c( "Educaci√≥n b√°sica"=1,
                                                        "Educaci√≥n media"=2,
                                                        "Educaci√≥n superior"=3))


sjmisc::frq(proc_data$educacion)
```
**La funci√≥n car::recode() agrupa categor√≠as originales de la variable educacion en tres niveles m√°s generales:**

Valores 1,2,3 ‚Üí se recodifican como 1 (Educaci√≥n b√°sica).

Valores 4,5 ‚Üí se recodifican como 2 (Educaci√≥n media).

Valores 6,7,8,9,10 ‚Üí se recodifican como 3 (Educaci√≥n superior).

El objetivo es simplificar la variable educacional en tres grupos.

**La funcion sjlabelled::set_labels()en el fondo es poner etiquetas de valor para que los numeros (1,2,3) tengan nombres legibles.**

```{r, eval=FALSE}
#sjmisc::frq(proc_data$educacion)

Value |              Label |    N | Raw % | Valid % | Cum. %
------------------------------------------------------------
    1 |   Educaci√≥n b√°sica |  781 | 22.86 |   22.88 |  22.88
    2 |    Educaci√≥n media | 1432 | 41.91 |   41.96 |  64.84
    3 | Educaci√≥n superior | 1200 | 35.12 |   35.16 | 100.00
 <NA> |               <NA> |    4 |  0.12 |    <NA> |   <NA>
```
**La funci√≥n frq() del paquete sjmisc muestra una tabla de frecuencias:**

- N√∫mero de casos en cada categor√≠a.

- Porcentaje relativo.

- Valores perdidos (NA) si los hay.

## Tabla de contingencia

Definici√≥n: Una **tabla de contingencia** (o tabla cruzada) es una matriz que muestra la distribuci√≥n conjunta de dos variables categ√≥ricas.

**Componentes Esenciales:**

- **Frecuencias observadas:** Conteos en cada combinaci√≥n de categor√≠as

- **Marginales de fila:** Totales por categor√≠a de la variable X

- **Marginales de columna:** Totales por categor√≠a de la variable Y

- **Gran total:** N√∫mero total de casos v√°lidos

```{r, eval=FALSE}
sjPlot::sjt.xtab(var.row = proc_data$educacion, var.col = proc_data$aut_demo, 
                 show.summary = F, emph.total = T, encoding = "UTF-8")
```

[Ver tabla de contingencia](practicos/Imagenesygraficos/tabla_contingencia.html)

*Sumado a esto, tenemos:

**Frecuencias absolutas:** n√∫meros que aparencen en la tabla (ya sean conjuntas o marginales)

**Frecuencias relativas:**
- porcentaje fila: % que cada frecuencia conjunta representa sobre la marginal de su fila
- porcentaje columna: % que cada frecuencia conjunta representa sobre la marginal de su columna
- porcentaje total: % que cada frecuencia conjunta representa sobre el n√∫mero total de casos de la tabla

Veamos c√≥mo incorporar el porcentaje fila y columna en la tabla.

```{r, eval=FALSE}
sjPlot::sjt.xtab(var.row = proc_data$educacion, 
                 var.col = proc_data$aut_demo, 
                 show.summary = F, 
                 emph.total = T, 
                 show.row.prc = T, # porcentaje fila
                 show.col.prc = T, # porcentaje columna
                 encoding= "UTF-8")
```

[Ver tabla de contingencia](practicos/Imagenesygraficos/tabla_contingenciapor.html)

Aqu√≠, los porcentajes fila aparecen en azul y los porcentajes columna en verde.

# Prueba Chi-cuadrado (X¬≤)

Calculo en R.

```{r, eval=FALSE}
chi_results <- chisq.test(table(proc_data$educacion, proc_data$aut_demo))

stats.table <- tidy(chi_results, conf_int = T)
nice_table(stats.table)
```

[Ver tabla de contingencia](practicos/Imagenesypracticos/chicuadrado.html)

Visualizacion de esta prueba y su zona de rechazo.

```{r, eval=FALSE}
ggchisqtest(chi_results)
```


### C√°lculo manual de X¬≤

### C√°lculo de X¬≤ en R

## Interpretaci√≥n del resultado

